define(["jquery","underscore","backbone","views/video-embed","views/outter-tile","match_media","bootstrap_transition","bootstrap_collapse","bootstrap_modal","bootstrap_carousel"],function(e,t,n,r,i,s){var o,u=n.View.extend({el:"body",events:{'change.checkbox.update input[type="checkbox"]':"update_checkbox","change.select.update .selectbox":"update_selectbox",'click.slide [data-slide="toggle"]':"slide_toggle",'click.accordian [data-toggle="collapse"]':"accordian_toggle"},initialize:function(){o=this;var n=e("html").hasClass("ie9"),r=e("html").hasClass("lt-ie9");o.$content=o.$el.find(".content"),o.$forms=o.$content.find("form"),o.$grids=o.$content.find(".grid"),o.$cols=o.$content.find(".col"),o.outter_columns=[],o.outter_rows=[],o.defaults={max_width:parseInt(o.$content.css("maxWidth"),10),max_height:parseInt(o.$content.css("maxHeight"),10),image_width:16.66667},o.resize_timer,o.update_checkbox(),o.build_selectbox(),o.preload_tiles(o.$el.find(".image-wrap, .ambassador-video-tile")),o.render_outter_grid(),e(window).on("resize",o.resize),(n||r)&&e(window).on("load",function(){t.each([o.outter_columns,o.outter_rows],function(e){t.each(e,function(e){e.update_values()})})})},update_checkbox:function(t){var n;t?n=e(t.currentTarget):n=o.$forms.find('input[type="checkbox"]'),e.each(n,function(){e(this).parent().find(".tickbox").toggleClass("checked",e(this).is(":checked"))})},resize:function(){console.log("resizing"),o.resizing=!0,clearTimeout(o.resize_timer),o.resize_timer=setTimeout(function(){o.render_outter_grid()},100)},build_selectbox:function(t){o.$forms.find(".selectbox").each(function(){e(this).wrap('<div class="select-wrapper"></div>'),e(this).after('<div class="holder"></div><div class="angle-down-box"><i class="fa fa-angle-down"></i></div>')}),o.update_selectbox()},update_selectbox:function(t){var n;t?n=e(t.currentTarget):n=o.$forms.find(".selectbox"),e.each(n,function(){var t=e(this).next(".holder");this.selectedIndex===0?t.addClass("first-option"):t.removeClass("first-option"),t.text(e(this).find(":selected").text())})},preload_tiles:function(t){e.each(t,function(t){var n=e(this).find("img");n.css({visibility:"hidden",opacity:0}).on("load",o.stop_loader),o.start_loader(e(this),n)})},start_loader:function(t,n){var r;t.append('<span class="loader"></span>'),r=t.find(".loader");var i=function(t){e({deg:0}).animate({deg:360},{duration:1e3,easing:"linear",step:function(e,t){r.css({transform:"rotate("+e+"deg)"})},complete:function(){n[0].complete||i(360)}})};i(360)},stop_loader:function(t){e(this).siblings(".loader").remove().end().css({visibility:"visible"}).animate({opacity:1},700)},accordian_toggle:function(t){e(t.currentTarget).closest("ul").find("a").removeClass("active"),e(t.currentTarget).addClass("active")},slide_toggle:function(t){var n=e(e(t.currentTarget).data("slide-target")),r;t.preventDefault(),n.hasClass("active")?r={grids:{start_left:"",position:""},cols:{start_left:"-100%",end_left:""}}:r={grids:{start_left:"-100%",position:"static"},cols:{start_left:"100%",end_left:""}},s.tablet()?(n.toggleClass("active inactive"),o.$grids.not(n.find(o.$grids)).fadeToggle({complete:function(){n.css({position:r.grids.position})}})):(o.$grids.not(n.find(o.$grids)).toggleClass("active inactive").each(function(t){e(this).animate({left:r.grids.start_left})}),n.toggleClass("active inactive"))},render_outter_grid:function(){var n=e(window).width(),r=e(window).height(),i,u;s.tablet()?o.$content.css({width:"",height:""}):(t.each([o.outter_columns,o.outter_rows],function(e){t.each(e,function(e){e.remove()})}),n>o.defaults.max_width?o.equalize_columns(n,n-o.defaults.max_width):o.set_outter_grid_defaults("width"),r>o.defaults.max_height?(i=parseInt(o.$el.find(".master-head").height(),10),u=parseInt(o.$el.find(".master-foot").height(),10),o.equalize_rows(r,r-o.defaults.max_height-i-u,i)):o.set_outter_grid_defaults("height"),t.each([o.outter_columns,o.outter_rows],function(e){t.each(e,function(e){e.append_tiles(),e.update_values(),e.preload_tiles()})}))},equalize_columns:function(e,t){o.outter_columns=[],o.set_outter_grid_defaults("width");var n=o.$content.width(),r=o.$content.height(),s=n,u=n/100*o.defaults.image_width,a=Math.ceil(t/u),f=[],l;while(s/100*o.defaults.image_width>=t/a)s--,t++,s=s;o.$content.css({width:s+"px"});for(var c=0;c<a;c++)l=new i({parent:o,type:"column",className:"appended-tiles appended-col",styles:{width:(e-s)/a+"px",left:s+s/100*o.defaults.image_width*c+"px"}}),o.outter_columns.push(l),f.push(l.render().el);o.$content.after(f)},equalize_rows:function(e,t,n){o.outter_rows=[],o.set_outter_grid_defaults("height");var r=o.$content.height(),s=o.$content.width(),u=r,a=r/100*50/2,f=Math.ceil(t/a),l=[],c;while(u/100*50/2>=t/f)u--,t++,u=u;o.$content.css({height:u+"px"});for(var h=0;h<f;h++)c=new i({parent:o,type:"row",className:"appended-tiles appended-row",styles:{height:u/100*50/2+"px",top:u+n+u/100*50/2*h+"px"}}),o.outter_rows.push(c),l.push(c.render().el);o.$content.after(l)},set_outter_grid_defaults:function(e){var t={};t[e]="",o.$content.css(t)}});return u});