define(["jquery","underscore","backbone","config/config","modules/asset-loader","collections/tiles-data","match_media"],function(e,t,n,r,i,s,o){var u=this,a=function(){u=this;var e=[],t,n={x:0,y:0},o,a,f;this.assetLoader=new i,this.assetLoader.onLoadComplete=this.onInitialLoadComplete.bind(this),this.createLoader();for(var l=0;l<s.content.length;l++){f=1;switch(s.content[l].tiletype){case"text":case"textlink":s.content[l].image=new Image,s.content[l].image.src=r.REMOTE_PATH+s.content[l].subimageurl,e.push(r.REMOTE_PATH+s.content[l].subimageurl);break;case"image":s.content[l].image=new Image,s.content[l].image.src=r.REMOTE_PATH+s.content[l].imageurl,e.push(r.REMOTE_PATH+s.content[l].imageurl),s.content[l].storyimage=new Image,s.content[l].storyimage.src=r.REMOTE_PATH+s.content[l].storyimageurl,e.push(r.REMOTE_PATH+s.content[l].storyimageurl);break;case"video":f=2,s.content[l].image=new Image,s.content[l].image.src=r.REMOTE_PATH+s.content[l].imageurl,e.push(r.REMOTE_PATH+s.content[l].imageurl),s.content[l].subimage=new Image,s.content[l].subimage.src=r.REMOTE_PATH+s.content[l].subimageurl,e.push(r.REMOTE_PATH+s.content[l].subimageurl)}s.content[l].scale=f,o={x:0,y:0};do{a=!1,o.x+s.content[l].scale-1>=s.worldWidth&&(a=!0);for(var c=0;c<l;c++)o.x>=s.content[c].position.x&&o.x<=s.content[c].position.x+s.content[c].scale-1&&o.y>=s.content[c].position.y&&o.y<=s.content[c].position.y+s.content[c].scale-1&&(a=!0);a||(s.content[l].position={x:o.x,y:o.y}),o.x+=1,o.x>=s.worldWidth&&(o.x=0,o.y+=1)}while(a&&o.y<100&&o.x<100)}u.assetLoader.addImages(e),u.assetLoader.load()};return a.constructor=a,a.prototype.createLoader=function(){this.overlay=document.createElement("div"),this.overlay.className="loading-overlay",this.spinner=document.createElement("div"),this.spinner.className="loader",this.overlay.appendChild(this.spinner),document.body.appendChild(this.overlay),this.updatePoller.apply(this)},a.prototype.updatePoller=function(){this.$spinner=e(this.spinner);var t=function(n){e({deg:0}).animate({deg:360},{duration:1e3,easing:"linear",step:function(e){u.$spinner.css({transform:"rotate("+e+"deg)"})},complete:function(){u.loaded||t(360)}})};t(360)},a.prototype.onInitialLoadComplete=function(){this.loaded=!0,this.assetLoader.onLoadComplete=null,this.onIntroComplete()},a.prototype.onFaded=function(){},a.prototype.onZoomStart=function(){},a.prototype.onIntroComplete=function(){this.onComplete(),e(this.overlay).fadeOut()},a.prototype.onInitialLoad=function(){},a.prototype.resize=function(){},a.prototype.destroy=function(){},a});