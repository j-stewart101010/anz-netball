define(["jquery","config/config","modules/asset-loader","models/tile","match_media"],function(e,t,n,r,i){var s=this,o=function(){s=this;var e=[],i,o={x:0,y:0},u,a,f;this.assetLoader=new n,this.assetLoader.onLoadComplete=this.onInitialLoadComplete.bind(this),this.createLoader();for(var l=0;l<r.content.length;l++){f=1;switch(r.content[l].tiletype){case"text":case"textlink":r.content[l].image=new Image,r.content[l].image.src=t.REMOTE_PATH+r.content[l].subimageurl,e.push(t.REMOTE_PATH+r.content[l].subimageurl);break;case"image":r.content[l].image=new Image,r.content[l].image.src=t.REMOTE_PATH+r.content[l].imageurl,e.push(t.REMOTE_PATH+r.content[l].imageurl),r.content[l].storyimage=new Image,r.content[l].storyimage.src=t.REMOTE_PATH+r.content[l].storyimageurl,e.push(t.REMOTE_PATH+r.content[l].storyimageurl);break;case"video":f=2,r.content[l].image=new Image,r.content[l].image.src=t.REMOTE_PATH+r.content[l].imageurl,e.push(t.REMOTE_PATH+r.content[l].imageurl),r.content[l].subimage=new Image,r.content[l].subimage.src=t.REMOTE_PATH+r.content[l].subimageurl,e.push(t.REMOTE_PATH+r.content[l].subimageurl)}r.content[l].scale=f,u={x:0,y:0};do{a=!1,u.x+r.content[l].scale-1>=r.worldWidth&&(a=!0);for(var c=0;c<l;c++)u.x>=r.content[c].position.x&&u.x<=r.content[c].position.x+r.content[c].scale-1&&u.y>=r.content[c].position.y&&u.y<=r.content[c].position.y+r.content[c].scale-1&&(a=!0);a||(r.content[l].position={x:u.x,y:u.y}),u.x+=1,u.x>=r.worldWidth&&(u.x=0,u.y+=1)}while(a&&u.y<100&&u.x<100)}s.assetLoader.addImages(e),s.assetLoader.load()};return o.constructor=o,o.prototype.createLoader=function(){this.overlay=document.createElement("div"),this.overlay.className="loading-overlay",this.spinner=document.createElement("div"),this.spinner.className="loader",this.overlay.appendChild(this.spinner),document.body.appendChild(this.overlay),this.updatePoller.apply(this)},o.prototype.updatePoller=function(){this.$spinner=e(this.spinner);var t=function(n){e({deg:0}).animate({deg:360},{duration:1e3,easing:"linear",step:function(e){s.$spinner.css({transform:"rotate("+e+"deg)"})},complete:function(){s.loaded||t(360)}})};t(360)},o.prototype.onInitialLoadComplete=function(){this.loaded=!0,this.assetLoader.onLoadComplete=null,this.onIntroComplete()},o.prototype.onFaded=function(){},o.prototype.onZoomStart=function(){},o.prototype.onIntroComplete=function(){this.onComplete(),e(this.overlay).fadeOut()},o.prototype.onInitialLoad=function(){},o.prototype.resize=function(){},o.prototype.destroy=function(){},o});