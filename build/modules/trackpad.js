define(["jquery","config/config"],function(e,t){var n=function(t){this.target=t,this.value=0,this.easingValue=0,this.dragOffset=0,this.dragging,this.speed=0,this.prevPosition=0,this.valueY=0,this.easingValueY=0,this.dragOffsetY=0,this.speedY=0,this.prevPositionY=0,e(this.target).mousedown(this.onMouseDown.bind(this)),this.target.onmousewheel=this.onMouseWheel.bind(this),document.ontouchstart=this.onTouchStart.bind(this),e(document).keydown(this.onArrow.bind(this))};return n.constructor=n,n.prototype.unlock=function(){this.locked=!1,this.speed=0,this.easingValue=this.value,this.target.focus(),this.target.onmousewheel=this.onMouseWheel.bind(this)},n.prototype.lock=function(){this.locked=!0},n.prototype.update=function(){if(this.value=this.easingValue,this.valueY=this.easingValueY,this.dragging){var e=this.easingValue-this.prevPosition;e*=.7,this.speed+=.5*(e-this.speed),this.prevPosition=this.easingValue;var t=this.easingValueY-this.prevPositionY;t*=.7,this.speedY+=.5*(t-this.speedY),this.prevPositionY=this.easingValueY}else this.speed*=.95,this.speedY*=.95,this.easingValue+=this.speed,this.easingValueY+=this.speedY},n.prototype.onArrow=function(e){return 38==e.keyCode?(this.speed=4,!1):40==e.keyCode?(this.speed-=4,!1):void 0},n.prototype.setPosition=function(e,t){this.value=this.easingValue=e,this.valueY=this.easingValueY=t},n.prototype.onMouseWheel=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,this.dragging=!1,this.locked||(this.speed=.15*e.wheelDeltaX,this.speedY=.15*e.wheelDeltaY)},n.prototype.startDrag=function(e,t){this.locked||(this.dragging=!0,this.dragOffset=e-this.value,this.dragOffsetY=t-this.valueY)},n.prototype.endDrag=function(){this.locked||(this.dragging=!1)},n.prototype.updateDrag=function(e,t){this.locked||(this.easingValue=e-this.dragOffset,this.easingValueY=t-this.dragOffsetY)},n.prototype.onMouseDown=function(t){if(!this.locked){t&&t.preventDefault(),t&&t.preventDefault();var n=t||window.event;n.returnValue=!1,e(document).mousemove(e.proxy(this.onMouseMove,this)),e(document).mouseup(e.proxy(this.onMouseUp,this)),this.startDrag(t.clientX,t.clientY)}},n.prototype.onMouseMove=function(e){e&&e.preventDefault();var t=e||window.event;this.updateDrag(t.clientX,t.clientY)},n.prototype.onMouseUp=function(){e(document).unbind("mousemove",e.proxy(this.onMouseMove,this)),e(document).unbind("mouseup",e.proxy(this.onMouseUp,this)),this.endDrag()},n.prototype.onTouchStart=function(e){console.log("TOUCH START"),document.ontouchmove=this.onTouchMove.bind(this),document.ontouchend=this.onTouchEnd.bind(this),this.startDrag(e.touches[0].clientX,e.touches[0].clientY)},n.prototype.onTouchMove=function(e){console.log("TOUCH MOVE"+e.touches[0].clientX+" : "+e.touches[0].clientY),e.preventDefault(),this.updateDrag(e.touches[0].clientX,e.touches[0].clientY)},n.prototype.onTouchEnd=function(){console.log("TOUCH END"),document.ontouchmove=null,document.ontouchend=null,this.endDrag()},n});